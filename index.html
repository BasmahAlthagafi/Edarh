<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة بصمة | ثانوية مشاعل بنت عبدالعزيز</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #764ba2; --secondary: #667eea; --accent: #ff9a9e; --bg: #f8f9fa; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; color: #2d3436; overflow-x: hidden; }
        
        /* صفحة الدخول */
        #loginPage { display: flex; align-items: center; justify-content: center; height: 100vh; background: linear-gradient(135deg, var(--primary), var(--secondary)); }
        .login-card { background: white; padding: 40px; border-radius: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.2); width: 320px; text-align: center; }
        .login-card input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 10px; font-family: 'Cairo'; box-sizing: border-box; }
        .btn-login { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-family: 'Cairo'; }

        /* البنر العلوي للمنصة */
        .banner { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; padding: 30px; text-align: center; border-bottom-left-radius: 50px; border-bottom-right-radius: 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .banner h2 { margin: 5px 0; font-weight: 800; }
        .banner-info { display: flex; justify-content: center; gap: 40px; margin-top: 15px; font-size: 0.9rem; opacity: 0.9; }

        /* التنقل */
        .main-nav { display: flex; justify-content: center; gap: 20px; margin: 30px 0; padding: 0 10px; }
        .nav-btn { padding: 12px 25px; border: none; border-radius: 50px; background: white; color: var(--primary); font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: 0.3s; font-family: 'Cairo'; }
        .nav-btn.active { background: var(--primary); color: white; }

        .container { max-width: 900px; margin: auto; padding: 20px; }
        .class-card { background: white; border-radius: 25px; margin-bottom: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.03); border: 1px solid #eee; overflow: hidden; }
        .class-header { padding: 20px; background: #fcfaff; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 700; }
        .class-content { display: none; padding: 20px; }

        .type-btns { display: flex; gap: 10px; margin-bottom: 20px; }
        .type-btn { flex: 1; padding: 10px; border: 2px solid #eee; border-radius: 15px; cursor: pointer; text-align: center; transition: 0.3s; font-size: 0.9rem; }
        .type-btn.active { border-color: var(--primary); background: #f8f7ff; color: var(--primary); font-weight: bold; }

        .items-list { background: #fafafa; border-radius: 15px; padding: 15px; }
        .evaluation-item { display: flex; flex-direction: column; padding: 10px 0; border-bottom: 1px solid #eee; gap: 10px; }
        .stars { display: flex; justify-content: center; gap: 10px; }
        .star { width: 35px; height: 35px; border-radius: 10px; border: 1px solid #ddd; display: flex; align-items: center; justify-content: center; cursor: pointer; background: white; transition: 0.2s; }
        .star.selected { background: var(--primary); color: white; border-color: var(--primary); transform: scale(1.1); }

        .result-box { margin-top: 20px; padding: 15px; border-radius: 15px; text-align: center; font-weight: bold; display: none; font-size: 0.9rem; }
        .report-btn-large { width: 90%; max-width: 500px; margin: 40px auto; display: block; padding: 18px; border: none; border-radius: 20px; background: #00b894; color: white; font-size: 1.1rem; font-weight: 800; cursor: pointer; font-family: 'Cairo'; }

        #reportPage { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; overflow-y: auto; padding: 20px; box-sizing: border-box; }
        .close-report { background: #ff7675; color: white; padding: 10px 20px; border-radius: 10px; display: inline-block; margin-bottom: 20px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="loginPage">
        <div class="login-card">
            <h2 style="color: var(--primary);">دخول المعلمات</h2>
            <input type="email" id="uEmail" placeholder="البريد الإلكتروني">
            <input type="password" id="uPass" placeholder="كلمة المرور">
            <button class="btn-login" onclick="login()">دخول المنصة</button>
        </div>
    </div>

    <div id="mainApp" style="display: none;">
        <div class="banner">
            <h2>ثانوية مشاعل بنت عبدالعزيز</h2>
            <div class="banner-info">
                <span>المديرة: نجلاء دهلوي</span>
                <span>المعلمة: بسمة الثقفي</span>
            </div>
        </div>

        <div class="main-nav">
            <button class="nav-btn active" id="btnM" onclick="switchTab('moasherat')">مؤشرات سير الحصة</button>
            <button class="nav-btn" id="btnE" onclick="switchTab('environment')">جودة البيئة التعليمية</button>
        </div>

        <div class="container" id="mainContainer"></div>
        <button class="report-btn-large" onclick="showReport()">التقرير الشامل</button>
    </div>

    <div id="reportPage">
        <div class="close-report" onclick="document.getElementById('reportPage').style.display='none'">إغلاق</div>
        <h2 style="text-align:center">تحليل الأداء الشامل للفصول</h2>
        <canvas id="chart"></canvas>
        <div id="analysis" style="margin-top:20px; background: #f9f9f9; padding: 20px; border-radius: 20px;"></div>
    </div>

<script>
    const config = {
        moasherat: {
            classes: ["أولى ثانوي - 1", "أولى ثانوي - 2", "أولى ثانوي - 3"],
             حضورية: ["الانضباط والحضور", "التفاعل والمشاركة", "المهام الصفية", "العمل الجماعي", "المظهر التنظيمي", "الهدوء والاصغاء"],
            بعد: ["الحضور والالتزام التقني", "التفاعل النشط", "أدب التواصل الرقمي", "إنجاز التكاليف الإلكترونية", "الاستجابة للتعليمات"]
        },
        environment: {
            classes: ["أولى ثانوي - 1", "أولى ثانوي - 2", "أولى ثانوي - 3"],
            حضورية: ["نظافة المكان", "ترتيب المقاعد", "سلامة الممتلكات", "التنظيم الشخصي", "الهدوء الصفي"],
            بعد: ["احترام وقت الحصة", "جاهزية الأدوات", "الانضباط التقني", "آداب التواصل الرقمي", "التفاعل والمبادرة"]
        }
    };

    let currentTab = 'moasherat';
    let scores = {};

    function login() {
        if(document.getElementById('uEmail').value && document.getElementById('uPass').value) {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            render();
        }
    }

    function switchTab(t) {
        currentTab = t;
        document.getElementById('btnM').classList.toggle('active', t === 'moasherat');
        document.getElementById('btnE').classList.toggle('active', t === 'environment');
        render();
    }

    function render() {
        const cont = document.getElementById('mainContainer');
        cont.innerHTML = '';
        config[currentTab].classes.forEach((c, i) => {
            cont.innerHTML += `
                <div class="class-card">
                    <div class="class-header" onclick="toggle(${i})"><span>${c}</span><span>▼</span></div>
                    <div class="class-content" id="c-${i}">
                        <div class="type-btns">
                            <div class="type-btn" id="h-${i}" onclick="setMode(${i}, 'حضورية')">حضوري</div>
                            <div class="type-btn" id="b-${i}" onclick="setMode(${i}, 'بعد')">عن بعد</div>
                        </div>
                        <div id="items-${i}"></div>
                        <div id="res-${i}" class="result-box"></div>
                    </div>
                </div>`;
        });
    }

    function toggle(i) {
        const el = document.getElementById(`c-${i}`);
        el.style.display = el.style.display === 'block' ? 'none' : 'block';
    }

    function setMode(idx, mode) {
        document.getElementById(`h-${idx}`).className = 'type-btn ' + (mode==='حضورية'?'active':'');
        document.getElementById(`b-${idx}`).className = 'type-btn ' + (mode==='بعد'?'active':'');
        const items = config[currentTab][mode];
        document.getElementById(`items-${idx}`).innerHTML = `<div class="items-list">` + items.map((it, ii) => `
            <div class="evaluation-item">
                <span style="font-size:0.85rem">${it}</span>
                <div class="stars">${[1,2,3,4,5].map(n => `<div class="star" onclick="rate(${idx},'${mode}',${ii},${n},this)">${n}</div>`).join('')}</div>
            </div>`).join('') + `</div>`;
    }

    function rate(idx, mode, itemIdx, val, el) {
        Array.from(el.parentElement.children).forEach(s => s.classList.remove('selected'));
        el.classList.add('selected');
        const key = `${currentTab}-${idx}-${mode}`;
        if(!scores[key]) scores[key] = [];
        scores[key][itemIdx] = val;
        calc(idx, key);
    }

    function calc(idx, key) {
        const s = scores[key].filter(x => x);
        const avg = s.reduce((a,b) => a+b, 0) / s.length;
        const rb = document.getElementById(`res-${idx}`);
        rb.style.display = 'block';
        let txt = avg >= 4.5 ? "ممتاز" : avg >= 4 ? "جيد جداً" : avg >= 3.5 ? "جيد" : "يحتاج تحسين";
        rb.innerText = `النتيجة: ${avg.toFixed(1)} - ${txt}`;
        rb.style.background = avg >= 4 ? "#e3fcef" : "#fff5f5";
    }

    function showReport() {
        document.getElementById('reportPage').style.display = 'block';
        new Chart(document.getElementById('chart'), {
            type: 'bar',
            data: { labels: ['فصل 1', 'فصل 2', 'فصل 3'], datasets: [{ label: 'مستوى الأداء', data: [4.5, 4.0, 3.8], backgroundColor: '#764ba2' }] }
        });
        document.getElementById('analysis').innerHTML = "<h3>التوصيات التربوية:</h3><ul><li>تعزيز نقاط القوة في الانضباط.</li><li>تكثيف التفاعل في الحصص التقنية.</li></ul>";
    }
</script>
</body>
</html>
